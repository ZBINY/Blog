<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="../node_modules/xterm/css/xterm.css" />
    <script src="../node_modules/xterm/lib/xterm.js"></script>
  </head>
  <body>
    <div id="terminal"></div>
    <script>
      var term = new Terminal({
        rendererType: "canvas", //渲染类型
        // rows: this.rows, //行数
        // cols: this.cols, // 不指定行数，自动回车后光标从下一行开始
        convertEol: true, //启用时，光标将设置为下一行的开头
        // scrollback: 50, //终端中的回滚量
        disableStdin: false, //是否应禁用输入
        // cursorStyle: "underline", //光标样式
        cursorBlink: true, //光标闪烁
        theme: {
          foreground: "#ECECEC", //字体
          background: "#000000", //背景色
          cursor: "help", //设置光标
          lineHeight: 20
        }
      });
      term.open(document.getElementById("terminal"));
      term.write("Hello from \x1B[1;3;31mxterm.js\x1B[0m $ ");
      // term.writeln('This is Web Terminal of Modb; Good Good Study, Day Day Up.')
      term.prompt = ()=> {
        term.write("\r\n\x1b[33m$\x1b[0m ")
      }

      term.prompt();
      // 添加事件监听器，支持输入方法
      term.onKey((e) => {
        const printable =
          !e.domEvent.altKey &&
          !e.domEvent.altGraphKey &&
          !e.domEvent.ctrlKey &&
          !e.domEvent.metaKey;
        if (e.domEvent.keyCode === 13) {
          term.prompt();
        } else if (e.domEvent.keyCode === 8) {
          // back 删除的情况
          if (term._core.buffer.x > 2) {
            term.write("\b \b");
          }
        } else if (printable) {
          term.write(e.key);
        }
        console.log(1, "print", e.key);
      });
      term.onData((key) => {
        // 粘贴的情况
        if (key.length > 1) term.write(key);
      });
    </script>
  </body>
</html>
